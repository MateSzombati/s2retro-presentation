<div class="row-container">
  <div class="grid-row" (click)="toggleExpand($event)" [ngClass]="{ 'active': isExpanded }">
    
    @for (col of columns; track col) {
      <div class="grid-cell">
        
        @if (col === 'name') {
          <input 
            class="layout-name-input"
            type="text" 
            [(ngModel)]="rowData[col]" 
            placeholder="Enter name"
            (click)="$event.stopPropagation()"
            (focus)="selectAllText($event)" />
        } 
        @else if (col === 'action') {
          <div style="display: flex; justify-content: right; width: 100% !important;">
            <button class="dropdown-btn" (click)="$event.stopPropagation(); toggleExpand($event)">
              <svg class="dropdown-icon" [class.clicked]="isExpanded" style="scale: 1.5;" width="30" height="25" viewBox="0 0 26 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g filter="url(#filter0_d_109_19)">
                  <path d="M20.5 8.25L13 15.75L5.5 8.25" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                </g>
                <defs>
                  <filter id="filter0_d_109_19" x="-3" y="0" width="32" height="32" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                    <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                    <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
                    <feOffset dy="4"/>
                    <feGaussianBlur stdDeviation="2"/>
                    <feComposite in2="hardAlpha" operator="out"/>
                    <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
                    <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_109_19"/>
                    <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_109_19" result="shape"/>
                  </filter>
                </defs>
              </svg>
            </button>
          </div>
        } @else {
          {{ columnsCounter }}/{{this.maxColumns}}
        }

      </div>
    }
  </div>

    <div class="dropdown" [class.expanded]="isExpanded">
     <div class="editor-container">
        <app-add-edit-boardlayout [layoutColumns]="rowData.columns!" (onColumnDelete)="onDeleteColumn($event)"></app-add-edit-boardlayout>
     </div>
     <div class="editor-controls">
        <button class="add-col-btn" (click)="onAddColumnClick()" [disabled]="addColumnDisabled">
          <p style="font-size: 15px; font-weight: 200; margin-right: 5px;">+</p>
          <p>Add Column</p>
        </button>
        <button class="save-layout-btn" (click)="onSaveClick()">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 256 256" style="width: 17px;">
            <path d="M219.31,72,184,36.69A15.86,15.86,0,0,0,172.69,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V83.31A15.86,15.86,0,0,0,219.31,72ZM168,208H88V152h80Zm40,0H184V152a16,16,0,0,0-16-16H88a16,16,0,0,0-16,16v56H48V48H172.69L208,83.31ZM160,72a8,8,0,0,1-8,8H96a8,8,0,0,1,0-16h56A8,8,0,0,1,160,72Z"></path>
          </svg>
          <p>Save</p>
        </button>
        @if (!isArchiveView) {
          <button class="del-layout-btn" (click)="openDeleteDialog()">
            <svg style="width: 17px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z" />
            </svg>
            <p>Archive Layout</p>
          </button>
        }
        @else {
          <button class="restore-layout-btn" (click)="restoreLayout()">
            <svg style="width: 17px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3" />
            </svg>
            <p>Restore Layout</p>
          </button>
        }
        
     </div>
  </div>
</div>